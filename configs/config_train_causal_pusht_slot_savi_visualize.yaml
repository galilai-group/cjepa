#output_dir: ./outputs

defaults:
  - _self_
  - override hydra/hydra_logging: disabled
  - override hydra/job_logging: disabled

hydra:
  output_subdir: null

wandb:
  enable: true
  project: cjepa_predictor_only
  entity: heejeong_nam-brown-university


task: clevrer_vqa
params: ???        # required (must be overridden)
exp_name: vis
out_dir: outputs/

# checkpoint paths
weight: ""         # load weight (optional)
ckpt_for_decoder: /cs/data/people/hnam16/.stable_worldmodel/artifacts/oc-checkpoints/pusht_savi_101_24.pth
ckpt_for_worldmodel: 134p_epoch_30

# training / system flags
fp16: false        # half-precision
ddp: false         # DDP training
cudnn: false       # cudnn benchmark

# distributed
local_rank: 0
dataset_name: pusht_expert
embedding_dir: '/cs/data/people/hnam16/data/modified_extraction/pusht_savi_101.pkl'
cache_dir: "/cs/data/people/hnam16/.stable_worldmodel"
action_dir: '/cs/data/people/hnam16/data/modified_extraction/pusht_expert_action_meta.pkl'
proprio_dir: '/cs/data/people/hnam16/data/modified_extraction/pusht_expert_proprio_meta.pkl'
state_dir: '/cs/data/people/hnam16/data/modified_extraction/pusht_expert_state_meta.pkl'

output_model_name: causal_world_model
training_type: video  # options: video, wm

trainer:
  max_epochs: 100
  # strategy: ddp 
  devices: auto
  accelerator: gpu 
  precision: 16-mixed
  log_every_n_steps: 1

batch_size: 256
num_workers: 10

seed: 42

image_size: 64
patch_size: 16

n_steps: ${eval:'${dinowm.num_preds} + ${dinowm.history_size}'}
frameskip: 5

savi:
  weight: /cs/data/people/hnam16/.stable_worldmodel/artifacts/oc-checkpoints/pusht_savi_101_24.pth
  params: slotformer/base_slots/configs/savi_pusht_ind_params_mlp.py
  NUM_SLOTS: 4
  SLOT_DIM: 128


dinowm:
  history_size: 3
  num_preds: 1
  proprio_dim: 4
  proprio_embed_dim: 12
  action_dim: 2
  action_embed_dim: 10

# Masked Slot Predictor Configuration
num_masked_slots: 0  # M: number of slots to mask during training

predictor:
  depth: 6
  heads: 15
  mlp_dim: 2048
  dim_head: 64
  dropout: 0.1
  emb_dropout: 0.0

predictor_lr: 5e-4
proprio_encoder_lr: 5e-4
action_encoder_lr: 5e-4

dump_object: true

